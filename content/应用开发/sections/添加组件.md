title: 添加组件
---
### 添加组件

>注意注意：更新完组件或者添加完组件，一定要
#<mark>重新打包，重新打包，重新打包，就是云打包一个新的调试版本App，然后重新安装到手机上覆盖以前旧版本的App</mark>

### 1. DeviceOne App的结构
DeviceOne的平台生成的App是由一个很小的原生核心和很多原生组件动态编译而成。组件都是可配置的，可以任意从组件商店里很多组件中选择若干个组件，通过搭积木的方式构建一个App。结构参考附件图：
![](../../images/tjzj001.png)

不管是发布版本还是调试版本，总体上分2部分：
* 原生二进制部分（不一定准确，便于理解）：这个部分就是图上的1，3，4部分。这个部分是app的基础，这个部分的任何功能的升级都必须整个安装包的升级，也就是apk和ipa的重新安装。
特别要注意的就是每个App都包含了很多个组件，组件都是可定制的，不同的开发者根据自己的应用的业务需求选择不同的组件，然后通过云编译成App，最后安装到手机上。组件的任何升级和增删都需要整个安装包的升级。

* DeviceOne文本部分（不一定准确，便于理解）：这个部分就是图上的2部分，这个部分就是用户用IDE开发的ui和js文件，包括一些其他资源文件，这个支持热升级，也就是单个文件的升级和更新，并不需要重新安装app。
调试版和发布版在这里的差别就是：调试版需要点击更新从IDE把部分2下载到手机上，这个部分可以被动态删除动态添加别的项目。而发布版打包的时候就固定了部分2，这个部分只能通过热更新来达到动态更新的目标。


### 2. 组件列表版本说明
提到组件列表，其实包含几个部分：
2.1. 项目里的组件列表：我们新建一个项目，或者导入一个项目，在项目的一个隐藏目录下保存了这个组件选择的所有组件的列表，每个组件对应一个文件，更新组件实际上是更新了这个目录下的所有文件。
>注意，这些文件都是在你的电脑上，和手机端无关

2.2. 调试版本的组件列表：这个调试App，名字是doDebugger，是通过项目打包生成的。这里的组件版本体现在这个安装包里，ios是ipa文件，android是apk文件。每一个组件对应着这个文件的一部分。更新组件列表需要重新打包生成安装包。
>注意，这个组件列表和项目的组件列表可以不一样。我可以用项目A对应的调试安装包去调试项目B。比如我们通常用官方提供的[调试包](http://doc.deviceone.net/web/doc/env/debug_app.htm),这个版本里的组件列表通常是最新的，而且挺全的。

2.3. 发布版本的组件列表：这个是和你的项目里的版本列表完全一致，是通过项目打包生成的。这里的组件版本体现在这个安装包里，ios是ipa文件，android是apk文件。每一个组件对应着这个文件的一部分。更新组件列表需要重新打包生成发布版本。

### 3. 为什么要添加和更新组件？
目前官方提供了近100个组件，还在不断增加中，我们这里开发一个App需要选择一些组件作为自己需要的组件列表。特别提示：可以通过 DeviceOne -->Tools -->  组件，来查看当前项目缺失组件，没用组件，应用组件等的列表，
#### 3.1 项目的组件列表
缺省新建一个项目只配置了最常用的大概20多个组件,另外新建的时候会选择当时最新的所有的组件版本。但是过一段时间，可能有更新的版本发布。

3.1.1. 不添加更多的组件，我们只能在IDE的可视化UI组件备选区看到15个左右组件。

	查看当前项目组件列表 Deviceone—Tools—组件—选择项目

>在UI组件备选区<mark>只能看到UI组件</mark>，SM和MM组件看不到，因为它们不能拖拽。
![](../../images/tjzj002.png)
3.1.2. 不添加更多的组件，我们在IDE的在线文档`Document`窗口只能看缺省带的组件的帮助，而且不一定是最新的。这个窗口能显示所有你这个项目选择组件的列表。
![](../../images/tjzj003.png)
3.1.3. 不添加更多的组件或更新组件，我们在IDE的js文件里的自动提示就没法正确提示。自动提示无法提示一个没添加的组件的属性，事件，方法。

#### 3.2 App包含的组件
目前官方提供了近200个组件，如果一个App把这些组件全选上，最后生成的安装包就几十M了，肯定没有必要，很多应用根本用不上这么多组件。

你的调试程序和发布程序，如果没有选择需要的组件或更新组件的版本，最后编译出来的App看不到效果，比如你想用百度地图，就必须选择do_BaiduMapView组件。否则会提示 `未知的组件xxxx之类的`的错误提示。

### 4. 如何添加和更新组件？
添加和更新组件也分二个步骤：更新项目的组件列表和更新App包含的组件
#### 4.1 项目的组件列表
4.1.1. 点击IDE菜单的`Config App`按钮，打开项目App的配置界面，其实是在浏览器里直接打开开发者中心的网址 https://developer.deviceone.net/app . 找到`组件配置`，就可以看到自己的应用的组件列表
![](../../images/tjzj004.png)
![](../../images/tjzj005.png)

4.1.2. 点击右上角的`添加组件`，然后就可以从`组件商店`里选择新组件或更新组件的版本。如果你开发了自己的组件，也可以从`内部组件`库里选择。
![](../../images/tjzj006.png)

4.1.3. 同步到本地的IDE，这一步最<mark>重要</mark>,前二步其实都是改的开发者中心里关于这个应用的配置。点击IDE菜单里的`同步`按钮：
![](../../images/tjzj007.png)
IDE会从服务器上把刚才的配置项下载到本地，下载需要几秒，等屏幕右下角出现提示`组件依赖更新完成`就可以了。关闭当前打开的ui文件，再打开一次就可以了。
![](../../images/tjzj008.png)

以上步骤完成后，就可以在备选区看到新加的UI组件，可以在Documents上看到所有组件列表，可以在js代码里看到最新的组件自动提示。

#### 4.2 App包含的组件
上面的步骤完成后，只是在IDE上看到添加组件的效果，要在手机上看到新组件的效果，还需要重新生成一个调试版本或发布版本的App，安装到手机上。
打包就是通过点击菜单上`调试版打包`和`发布版打包`就可以实现:
![](../../images/tjzj009.png)
打包需要几分钟的时间，打包结束后，可以下载到电脑上安装ipa和apk文件，也可以通过扫描二维码直接安装。
![](../../images/tjzj010.png)

是不是觉得添加一个组件或者更新一个组件好麻烦，没关系，我们官方每隔几天就会选择大部分组件生成一个调试版本供大家直接下载安装，省去了这个步骤。参考[文档](http://doc.deviceone.net/web/doc/env/debug_app.htm)
